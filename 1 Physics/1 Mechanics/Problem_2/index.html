<!DOCTYPE html>

<html class="writer-html5" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="../../../img/favicon.ico" rel="shortcut icon"/>
<title>Problem 2 - Physics and Mathematics</title>
<link href="../../../css/theme.css" rel="stylesheet"/>
<link href="../../../css/theme_extra.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" rel="stylesheet"/>
<script>
        // Current page data
        var mkdocs_page_name = "Problem 2";
        var mkdocs_page_input_path = "1 Physics/1 Mechanics/Problem_2.md";
        var mkdocs_page_url = null;
      </script>
<!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
<script>hljs.highlightAll();</script>
</head>
<body class="wy-body-for-nav" role="document">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side stickynav" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href="../../.."> Physics and Mathematics
        </a><div role="search">
<form action="../../../search.html" class="wy-form" id="rtd-search-form" method="get">
<input aria-label="Search docs" name="q" placeholder="Search docs" title="Type search term here" type="text"/>
</form>
</div>
</div>
<div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../..">Introduction</a>
</li>
</ul>
<p class="caption"><span class="caption-text">1 Physics</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal current">1 Mechanics</a>
<ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2 current"><a class="reference internal current" href="#">Problem 2</a>
<ul class="current">
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">2 Gravity</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_2/">Problem 2</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_3/">Problem 3</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">3 Waves</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../3%20Waves/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">4 Electromagnetism</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../4%20Electromagnetism/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">5 Circuits</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../5%20Circuits/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">6 Statistics</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../6%20Statistics/Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../6%20Statistics/Problem_2/">Problem 2</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">7 Measurements</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../7%20Measurements/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift">
<nav aria-label="Mobile navigation menu" class="wy-nav-top" role="navigation">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="../../..">Physics and Mathematics</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content"><div aria-label="breadcrumbs navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a aria-label="Docs" class="icon icon-home" href="../../.."></a></li>
<li class="breadcrumb-item">1 Physics</li>
<li class="breadcrumb-item">1 Mechanics</li>
<li class="breadcrumb-item active">Problem 2</li>
<li class="wy-breadcrumbs-aside">
</li>
</ul>
<hr/>
</div>
<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div class="section" itemprop="articleBody">
<h1 id="problem-2">Problem 2</h1>
<h1 id="investigating-the-dynamics-of-a-forced-damped-pendulum">Investigating the Dynamics of a Forced Damped Pendulum</h1>
<h2 id="1-motivation"><strong>1. Motivation</strong></h2>
<p>The forced damped pendulum is a classic example of a nonlinear system exhibiting a rich spectrum of dynamic behaviors. By introducing damping and external periodic forcing, the system transitions from simple harmonic motion to more complex phenomena, such as resonance, quasiperiodicity, and chaos. Understanding these dynamics is essential in fields ranging from mechanical engineering to climate modeling and electrical circuits.</p>
<p>The introduction of an external periodic force adds new parameters, including amplitude and frequency, which significantly affect the pendulum's motion. By varying these parameters, we can observe different behaviors, including synchronized oscillations, chaotic motion, and resonance effects. These dynamics not only illustrate fundamental physical principles but also provide practical insights into engineering applications such as energy harvesting, vibration isolation, and resonance mitigation.</p>
<hr/>
<h2 id="2-theoretical-foundation"><strong>2. Theoretical Foundation</strong></h2>
<h3 id="21-governing-differential-equation"><strong>2.1 Governing Differential Equation</strong></h3>
<p>The motion of a forced damped pendulum is governed by Newton’s Second Law applied to rotational motion:</p>
<div class="arithmatex">\[I \alpha = \sum \tau\]</div>
<p>For a simple pendulum of mass <span class="arithmatex">\(m\)</span> and length <span class="arithmatex">\(L\)</span>, the moment of inertia about the pivot is:</p>
<div class="arithmatex">\[I = mL^2\]</div>
<p>The forces acting on the pendulum bob include:</p>
<ul>
<li><strong>Gravitational force</strong>: Produces a restoring torque:</li>
</ul>
<div class="arithmatex">\[\tau_{\text{gravity}} = -mgL \sin \theta\]</div>
<ul>
<li><strong>Damping force</strong>: Opposes motion due to air resistance:</li>
</ul>
<div class="arithmatex">\[\tau_{\text{damping}} = -b L \frac{d\theta}{dt}\]</div>
<ul>
<li><strong>External forcing</strong>: A periodic force applied to the system:</li>
</ul>
<div class="arithmatex">\[\tau_{\text{forcing}} = F_0 L \cos(\omega t)\]</div>
<p>Applying Newton’s Second Law:</p>
<div class="arithmatex">\[mL^2 \frac{d^2\theta}{dt^2} = -mgL \sin\theta - b L \frac{d\theta}{dt} + F_0 L \cos(\omega t)\]</div>
<p>Dividing by <span class="arithmatex">\(mL^2\)</span>, we obtain the standard form:</p>
<div class="arithmatex">\[
\frac{d^2\theta}{dt^2} + \gamma \frac{d\theta}{dt} + \omega_0^2 \sin\theta = A \cos(\omega t)
\]</div>
<p>where:</p>
<ul>
<li><strong>Natural frequency</strong>: </li>
</ul>
<div class="arithmatex">\[\omega_0 = \sqrt{\frac{g}{L}}\]</div>
<ul>
<li><strong>Damping coefficient</strong>: </li>
</ul>
<div class="arithmatex">\[\gamma = \frac{b}{mL}\]</div>
<ul>
<li><strong>Forcing term</strong>: </li>
</ul>
<div class="arithmatex">\[A = \frac{F_0}{mL}\]</div>
<hr/>
<h3 id="12-approximate-solutions-for-small-angle-oscillations">1.2 Approximate Solutions for Small-Angle Oscillations</h3>
<p>For small angles <span class="arithmatex">\(\theta \ll 1\)</span>, we use the small-angle approximation:</p>
<div class="arithmatex">\[\sin\theta \approx \theta\]</div>
<p>Substituting this into the equation simplifies it to:</p>
<div class="arithmatex">\[\frac{d^2\theta}{dt^2} + b \frac{d\theta}{dt} + \frac{g}{L} \theta = A \cos(\omega t)\]</div>
<p>This is a linear inhomogeneous second-order differential equation that can be solved using standard techniques.</p>
<h4 id="121-general-solution">1.2.1 General Solution</h4>
<p>The general solution consists of:</p>
<ol>
<li>Homogeneous solution <span class="arithmatex">\(A = 0\)</span>, solving:</li>
</ol>
<div class="arithmatex">\[\frac{d^2\theta}{dt^2} + b \frac{d\theta}{dt} + \frac{g}{L} \theta = 0\]</div>
<p>The characteristic equation is:</p>
<div class="arithmatex">\[r^2 + br + \frac{g}{L} = 0\]</div>
<p>Solving for <span class="arithmatex">\(r\)</span>, the solution depends on the damping coefficient <span class="arithmatex">\(b\)</span>:</p>
<ul>
<li>Underdamped case <span class="arithmatex">\(b^2 &lt; 4g/L\)</span>:</li>
</ul>
<div class="arithmatex">\[\theta_h(t) = e^{-bt/2} (C_1 \cos(\omega{\prime} t) + C_2 \sin(\omega{\prime} t))\]</div>
<p>where $$ \omega{\prime} = \sqrt{\frac{g}{L} - \frac{b^2}{4}} $$ is the damped frequency.</p>
<ul>
<li>
<p>Overdamped and critically damped cases are handled similarly but result in non-oscillatory motion.</p>
</li>
<li>
<p>Particular solution for the forced term:</p>
</li>
</ul>
<div class="arithmatex">\[\theta_p(t) = A_0 \cos(\omega t - \delta)\]</div>
<p>where:</p>
<div class="arithmatex">\[A_0 = \frac{A}{\sqrt{\left(\frac{g}{L} - \omega^2\right)^2 + b^2 \omega^2}}\]</div>
<p>and</p>
<div class="arithmatex">\[\tan\delta = \frac{b\omega}{\frac{g}{L} - \omega^2}\]</div>
<p>Thus, the full solution is:</p>
<div class="arithmatex">\[\theta(t) = e^{-bt/2} (C_1 \cos(\omega{\prime} t) + C_2 \sin(\omega{\prime} t)) + A_0 \cos(\omega t - \delta)\]</div>
<p>where the first term decays over time, leaving only the steady-state oscillation.</p>
<hr/>
<h3 id="13-resonance-conditions-and-energy-implications">1.3 Resonance Conditions and Energy Implications</h3>
<p>Resonance occurs when the driving frequency <span class="arithmatex">\(\omega\)</span> approaches the system’s natural frequency:</p>
<div class="arithmatex">\[\omega \approx \sqrt{\frac{g}{L}}\]</div>
<p>At resonance, the amplitude <span class="arithmatex">\(A_0\)</span> is maximized:</p>
<div class="arithmatex">\[A_{\text{max}} \approx \frac{A}{b\omega}\]</div>
<p>which shows that:
- For small damping <span class="arithmatex">\(b \to 0\)</span>, the amplitude can grow excessively, leading to large oscillations.
- For strong damping, resonance is suppressed, and energy is dissipated before large oscillations develop.</p>
<p>The total energy of the system:</p>
<div class="arithmatex">\[E = \frac{1}{2} m L^2 \dot{\theta}^2 + \frac{1}{2} mgL \theta^2\]</div>
<p>is maximized at resonance, which can lead to destructive consequences in mechanical systems (e.g., bridges, buildings). Damping helps dissipate this energy and stabilize the system.</p>
<hr/>
<h2 id="22-python-visualizations">2.2  Python Visualizations</h2>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# Parameters
g = 9.81          # gravitational acceleration (m/s^2)
L = 1.0           # pendulum length (m)
b = 0.1           # damping coefficient (s^-1)
A = 0.5           # forcing amplitude
omega = np.sqrt(g / L)  # driving frequency (resonance condition, rad/s)
theta0 = 0.1      # initial angle (radians)
theta_dot0 = 0.0  # initial angular velocity (rad/s)

# Time settings
t_max = 20.0      # total simulation time (s)
dt = 0.01         # time step (s)
t = np.arange(0, t_max, dt)  # time array

# Define the system of ODEs
def pendulum_derivatives(t, state, b, g, L, A, omega):
    theta, theta_dot = state
    dtheta_dt = theta_dot
    dtheta_dot_dt = -b * theta_dot - (g / L) * theta + A * np.cos(omega * t)
    return np.array([dtheta_dt, dtheta_dot_dt])

# RK4 solver
def rk4_step(t, state, dt, b, g, L, A, omega):
    k1 = pendulum_derivatives(t, state, b, g, L, A, omega)
    k2 = pendulum_derivatives(t + dt/2, state + dt * k1/2, b, g, L, A, omega)
    k3 = pendulum_derivatives(t + dt/2, state + dt * k2/2, b, g, L, A, omega)
    k4 = pendulum_derivatives(t + dt, state + dt * k3, b, g, L, A, omega)
    return state + (dt / 6) * (k1 + 2*k2 + 2*k3 + k4)

# Initialize arrays
state = np.array([theta0, theta_dot0])  # [theta, theta_dot]
theta = np.zeros(len(t))
theta_dot = np.zeros(len(t))
theta[0], theta_dot[0] = state

# Simulate the motion
for i in range(1, len(t)):
    state = rk4_step(t[i-1], state, dt, b, g, L, A, omega)
    theta[i], theta_dot[i] = state

# Calculate total energy
m = 1.0  # mass (kg), assumed for simplicity
energy = 0.5 * m * L**2 * theta_dot**2 + 0.5 * m * g * L * theta**2

# Plotting
plt.figure(figsize=(12, 8))

# Angle vs Time
plt.subplot(2, 1, 1)
plt.plot(t, theta, label=r'$\theta(t)$')
plt.xlabel('Time (s)')
plt.ylabel('Angle (rad)')
plt.title('Forced Damped Pendulum Motion')
plt.grid(True)
plt.legend()

# Energy vs Time
plt.subplot(2, 1, 2)
plt.plot(t, energy, label='Total Energy', color='orange')
plt.xlabel('Time (s)')
plt.ylabel('Energy (J)')
plt.title('Total Energy Over Time')
plt.grid(True)
plt.legend()

plt.tight_layout()
plt.show()

# Optional: Phase space plot
plt.figure(figsize=(6, 6))
plt.plot(theta, theta_dot, label='Phase Trajectory')
plt.xlabel(r'$\theta$ (rad)')
plt.ylabel(r'$\dot{\theta}$ (rad/s)')
plt.title('Phase Space: Angle vs Angular Velocity')
plt.grid(True)
plt.legend()
plt.show()
</code></pre>
<p><img alt="alt text" src="../image-8.png"/>
<img alt="alt text" src="../image-9.png"/></p>
<h2 id="explanation-of-the-code">Explanation of the Code</h2>
<h3 id="parameters">Parameters</h3>
<p>The following physical constants and initial conditions are defined with realistic values:</p>
<ul>
<li><span class="arithmatex">\(g\)</span>: Gravitational acceleration (m/s²).</li>
<li><span class="arithmatex">\(L\)</span>: Pendulum length (m).</li>
<li><span class="arithmatex">\(b\)</span>: Damping coefficient (s⁻¹).</li>
<li><span class="arithmatex">\(A\)</span>: Forcing amplitude.</li>
<li><span class="arithmatex">\(\omega\)</span>: Driving frequency (rad/s), set to <span class="arithmatex">\(\omega = \sqrt{\frac{g}{L}}\)</span> to match the natural frequency for resonance.</li>
<li>Initial conditions:</li>
<li><span class="arithmatex">\(\theta_0\)</span>: Initial angle (radians), starting the pendulum slightly displaced.</li>
<li><span class="arithmatex">\(\dot{\theta}_0\)</span>: Initial angular velocity (rad/s).</li>
</ul>
<h3 id="ode-definition">ODE Definition</h3>
<p>The <code>pendulum_derivatives</code> function computes the derivatives of the system:</p>
<ul>
<li><span class="arithmatex">\(<span class="arithmatex">\(\frac{d\theta}{dt}\)</span>\)</span>: </li>
</ul>
<p>Angular velocity.</p>
<ul>
<li><span class="arithmatex">\(<span class="arithmatex">\(\frac{d\dot{\theta}}{dt}\)</span>\)</span>:</li>
</ul>
<p>Angular acceleration, based on the equation of motion.</p>
<h3 id="rk4-solver">RK4 Solver</h3>
<p>The <code>rk4_step</code> function implements the 4th-order Runge-Kutta method to advance the solution one time step:
- Numerically integrates the ODEs using four stages (k1, k2, k3, k4) to update <span class="arithmatex">\(\theta\)</span> and <span class="arithmatex">\(\dot{\theta}\)</span>.</p>
<h3 id="simulation">Simulation</h3>
<p>The simulation process:
- A loop iterates over time, updating:
  - <span class="arithmatex">\(\theta\)</span>: Angular displacement.
  - <span class="arithmatex">\(\dot{\theta}\)</span>: Angular velocity.
- Energy is calculated using:
  - <span class="arithmatex">\(<span class="arithmatex">\(E = \frac{1}{2} m L^2 \dot{\theta}^2 + \frac{1}{2} m g L \theta^2\)</span>\)</span> (small-angle potential energy, in joules).</p>
<h3 id="visualization">Visualization</h3>
<p>The results are visualized with:
- Two plots:
  1. Angle <span class="arithmatex">\((\theta)\)</span> vs. time.
  2. Energy <span class="arithmatex">\((E)\)</span> vs. time.
- A phase space plot:
  - <span class="arithmatex">\(\theta\)</span> vs. <span class="arithmatex">\(\dot{\theta}\)</span>, showing the system’s trajectory in phase space.</p>
<hr/>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import solve_ivp

# Define parameters
g = 9.81  # gravity (m/s^2)
L = 1.0   # length of pendulum (m)
b_values = [0.1, 0.5, 1.0]  # different damping coefficients
F0_values = [0.5, 1.2, 2.0]  # different forcing amplitudes
omega_values = [1.0, 2.0, 3.0]  # different driving frequencies

# Define natural frequency
def omega0(L):
    return np.sqrt(g / L)

# Define the system of equations
def forced_damped_pendulum(t, y, gamma, F0, omega):
    theta, omega_dot = y
    dtheta_dt = omega_dot
    domega_dt = -gamma * omega_dot - omega0(L)**2 * np.sin(theta) + F0 * np.cos(omega * t)
    return [dtheta_dt, domega_dt]

# Time array
t_span = (0, 50)
t_eval = np.linspace(0, 50, 1000)
y0 = [0.1, 0.0]  # small initial displacement

# Plot motion for different parameters
plt.figure(figsize=(12, 8))
for b in b_values:
    for F0 in F0_values:
        for omega in omega_values:
            gamma = b / L
            sol = solve_ivp(forced_damped_pendulum, t_span, y0, t_eval=t_eval, method='RK45', args=(gamma, F0, omega))
            plt.plot(sol.t, sol.y[0], label=f'b={b}, F0={F0}, omega={omega}')
plt.xlabel('Time (s)')
plt.ylabel('Angle (rad)')
plt.title('Forced Damped Pendulum Motion for Different Parameters')
plt.legend()
plt.grid()
plt.show()

# Phase portrait
plt.figure(figsize=(8, 6))
plt.plot(sol.y[0], sol.y[1], label='Phase Portrait')
plt.xlabel('Angle (rad)')
plt.ylabel('Angular Velocity (rad/s)')
plt.title('Phase Portrait of Forced Damped Pendulum')
plt.legend()
plt.grid()
plt.show()

# Poincare section
t_poincare = sol.t[::20]
theta_poincare = sol.y[0][::20]
omega_poincare = sol.y[1][::20]
plt.figure(figsize=(8, 6))
plt.scatter(theta_poincare, omega_poincare, s=10, color='r')
plt.xlabel('Angle (rad)')
plt.ylabel('Angular Velocity (rad/s)')
plt.title('Poincaré Section')
plt.grid()
plt.show()

# Bifurcation diagram
driver_freqs = np.linspace(0.5, 3.0, 50)
final_angles = []
for omega in driver_freqs:
    sol = solve_ivp(forced_damped_pendulum, t_span, y0, t_eval=t_eval, method='RK45', args=(0.5, 1.2, omega))
    final_angles.append(sol.y[0][-50:])

plt.figure(figsize=(8, 6))
for i, omega in enumerate(driver_freqs):
    plt.scatter([omega] * len(final_angles[i]), final_angles[i], s=1, color='b')
plt.xlabel('Driving Frequency (rad/s)')
plt.ylabel('Final Angles (rad)')
plt.title('Bifurcation Diagram')
plt.grid()
plt.show()

# Discussion on Model Limitations and Extensions
# Limitations:
# - Small-angle approximations do not hold for chaotic motion.
# - Linear damping may not accurately reflect real-world air resistance.
# - External forcing may not always be purely periodic.

# Extensions:
# - Nonlinear damping effects can be incorporated (e.g., quadratic drag).
# - Stochastic forcing can be introduced to model real-world perturbations.
# - Multi-degree-of-freedom systems can be explored for coupled oscillators.
</code></pre>
<p><img alt="alt text" src="../image-1.png"/>
<img alt="alt text" src="../image-2.png"/>
<img alt="alt text" src="../image-3.png"/>
<img alt="alt text" src="../image-4.png"/></p>
<h2 id="forced-damped-pendulum-simulation">Forced Damped Pendulum Simulation</h2>
<p>This Python code simulates a forced damped pendulum and visualizes its behavior using NumPy, Matplotlib, and SciPy. Here's a concise explanation:</p>
<h3 id="setup">Setup</h3>
<p>Defines parameters:
- Gravity: <span class="arithmatex">\(g=9.81,\text{m/s}^2\)</span>
- Pendulum length: <span class="arithmatex">\(L=1.0,\text{m}\)</span>
- Damping coefficients: <span class="arithmatex">\(b\)</span>
- Forcing amplitudes: <span class="arithmatex">\(F_0\)</span>
- Driving frequencies: <span class="arithmatex">\(\omega\)</span>
- Natural frequency: <span class="arithmatex">\(\omega_0=\sqrt{\frac{g}{L}}\)</span></p>
<h2 id="equations">Equations</h2>
<p>Models the pendulum with the ODE:
- <span class="arithmatex">\(\frac{d^2\theta}{dt^2}=-\gamma\dot{\theta}-\omega_0^2\sin(\theta)+F_0\cos(\omega t)\)</span></p>
<p>Split into two first-order equations:
- Angle: <span class="arithmatex">\(\theta\)</span>
- Angular velocity: <span class="arithmatex">\(\dot{\theta}\)</span></p>
<h2 id="simulation_1">Simulation</h2>
<ul>
<li>Uses <code>solve_ivp</code> with the RK45 method to solve the ODE over 50 seconds.</li>
<li>Initial condition: Small angle (0.1 rad).</li>
</ul>
<h2 id="plots">Plots</h2>
<ul>
<li><strong>Motion</strong>: Graphs <span class="arithmatex">\(\theta(t)\)</span> for combinations of <span class="arithmatex">\(b\)</span>, <span class="arithmatex">\(F_0\)</span>, and <span class="arithmatex">\(\omega\)</span>.</li>
<li><strong>Phase Portrait</strong>: Plots <span class="arithmatex">\(\theta\)</span> vs. <span class="arithmatex">\(\dot{\theta}\)</span> for one case.</li>
<li><strong>Poincaré Section</strong>: Scatters <span class="arithmatex">\(\theta\)</span> and <span class="arithmatex">\(\dot{\theta}\)</span> every 20th point.</li>
<li><strong>Bifurcation Diagram</strong>: Shows final <span class="arithmatex">\(\theta\)</span> values vs. driving frequency (<span class="arithmatex">\(\omega\)</span>).</li>
</ul>
<h2 id="discussion">Discussion</h2>
<ul>
<li><strong>Limitations</strong>:</li>
<li>No small-angle approximation.</li>
<li>Linear damping may not reflect real-world conditions.</li>
<li><strong>Extensions</strong>:</li>
<li>Nonlinear damping (e.g., quadratic drag).</li>
<li>Stochastic forcing for real-world perturbations.</li>
</ul>
<hr/>
<h2 id="html-simulation-for-further-implementation">HTML Simulation For Further Implementation</h2>
<h2 id="what-it-does">What It Does</h2>
<p>This Python script creates an interactive web-based simulation of a <strong>forced damped pendulum</strong>. It:</p>
<ul>
<li>Generates an HTML file (<code>pendulum_simulation.html</code>) with a canvas showing a pendulum and a chart plotting its motion.</li>
<li>Lets you adjust parameters (damping, driving amplitude, frequency) via sliders and start/stop the simulation with buttons.</li>
<li>Simulates the pendulum’s motion under gravity, damping, and an external driving force.</li>
</ul>
<h2 id="how-it-works">How It Works</h2>
<h3 id="structure">Structure</h3>
<ul>
<li>The code defines <code>html_content</code> as a triple-quoted string containing HTML, CSS, JavaScript, and Brython Python.</li>
<li>It writes this string to <code>pendulum_simulation.html</code> and saves it.</li>
</ul>
<h3 id="components">Components</h3>
<ul>
<li><strong>HTML/CSS</strong>: Sets up the webpage layout with sliders, buttons, a pendulum canvas, and a chart canvas.</li>
<li><strong>Brython</strong>: Runs Python in the browser (loaded via CDN), handling the simulation logic.</li>
<li><strong>Chart.js</strong>: Plots the pendulum’s angular displacement over time.</li>
</ul>
<h3 id="simulation-logic">Simulation Logic</h3>
<ul>
<li><strong>Physics</strong>: Uses the Runge-Kutta 4 (RK4) method to solve differential equations for a damped, driven pendulum:</li>
<li><code>dx_dt</code>: Calculates angular velocity and acceleration based on gravity, damping, and driving force.</li>
<li><code>rk4_step</code>: Updates the pendulum’s angle (<code>theta</code>) and velocity (<code>omega</code>) every time step (<code>dt = 0.01s</code>).</li>
<li><strong>Animation</strong>: The <code>animate()</code> function updates the pendulum’s position, redraws it on the canvas, and updates the chart every 10ms (if <code>running = True</code>).</li>
</ul>
<h3 id="interactivity">Interactivity</h3>
<ul>
<li><strong>Sliders</strong>: <code>updateParams()</code> adjusts <code>b</code> (damping), <code>F_d</code> (driving amplitude), and <code>omega_d</code> (driving frequency) in real-time.</li>
<li><strong>Buttons</strong>: </li>
<li><code>startSimulation()</code> resets variables and starts the animation loop.</li>
<li><code>stopSimulation()</code> pauses it by setting <code>running = False</code>.</li>
</ul>
<h3 id="execution">Execution</h3>
<ul>
<li>Run the Python script to create the HTML file.</li>
<li>Open the HTML file in a browser, where Brython executes the embedded Python, simulating the pendulum and responding to user input.</li>
</ul>
<hr/>
<pre><code class="language-python">from IPython.display import HTML

# Define the HTML content
html_content = """
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Forced Damped Pendulum Simulation&lt;/title&gt;
    &lt;script src="https://cdnjs.cloudflare.com/ajax/libs/brython/3.11.0/brython.min.js"&gt;&lt;/script&gt;
    &lt;script src="https://cdnjs.cloudflare.com/ajax/libs/brython/3.11.0/brython_stdlib.js"&gt;&lt;/script&gt;
    &lt;script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"&gt;&lt;/script&gt;
    &lt;style&gt;
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f0f0f0;
        }
        .container {
            margin: 20px auto;
            max-width: 800px;
        }
        canvas {
            border: 1px solid black;
            margin: 10px;
        }
        .controls {
            margin: 20px 0;
        }
        .controls label {
            margin-right: 10px;
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body onload="brython()"&gt;
    &lt;div class="container"&gt;
        &lt;h1&gt;Forced Damped Pendulum Simulation&lt;/h1&gt;
        &lt;div class="controls"&gt;
            &lt;label&gt;Damping Coefficient (b): &lt;input type="range" id="damping" min="0" max="0.2" step="0.01" value="0.05" oninput="updateParams()"&gt;&lt;/label&gt;
            &lt;span id="dampingValue"&gt;0.05&lt;/span&gt;&lt;br&gt;
            &lt;label&gt;Driving Amplitude (F_d): &lt;input type="range" id="drivingAmplitude" min="0" max="1.5" step="0.1" value="0.5" oninput="updateParams()"&gt;&lt;/label&gt;
            &lt;span id="drivingAmplitudeValue"&gt;0.5&lt;/span&gt;&lt;br&gt;
            &lt;label&gt;Driving Frequency (ω_d): &lt;input type="range" id="drivingFrequency" min="0" max="5" step="0.1" value="3.13" oninput="updateParams()"&gt;&lt;/label&gt;
            &lt;span id="drivingFrequencyValue"&gt;3.13&lt;/span&gt;&lt;br&gt;
            &lt;button onclick="startSimulation()"&gt;Start Simulation&lt;/button&gt;
            &lt;button onclick="stopSimulation()"&gt;Stop Simulation&lt;/button&gt;
        &lt;/div&gt;
        &lt;canvas id="pendulumCanvas" width="400" height="400"&gt;&lt;/canvas&gt;
        &lt;canvas id="chartCanvas" width="400" height="200"&gt;&lt;/canvas&gt;
    &lt;/div&gt;

    &lt;script type="text/python"&gt;
from browser import document, window, timer
import math

# Constants
g = 9.81  # Acceleration due to gravity (m/s^2)
L = 1.0   # Length of pendulum (m)
m = 0.1   # Mass of the bob (kg)
dt = 0.01  # Time step (s)
theta_0 = 0.1  # Initial angle (radians)
omega_0 = 0.0  # Initial angular velocity (radians/s)
omega_natural = math.sqrt(g / L)

# Global variables
b = 0.05  # Damping coefficient
F_d = 0.5  # Driving amplitude
omega_d = 3.13  # Driving frequency (near resonance)
theta = theta_0
omega = omega_0
t = 0.0
time_data = []
theta_data = []
running = False

# Canvas and Chart setup
canvas = document["pendulumCanvas"]
ctx = canvas.getContext("2d")
chartCanvas = document["chartCanvas"]
chartCtx = chartCanvas.getContext("2d")
chart = window.Chart.new(chartCtx, {
    "type": "line",
    "data": {
        "labels": [],
        "datasets": [{
            "label": "Angular Displacement (radians)",
            "data": [],
            "borderColor": "blue",
            "fill": False
        }]
    },
    "options": {
        "scales": {
            "x": {"title": {"display": True, "text": "Time (s)"}},
            "y": {"title": {"display": True, "text": "θ (radians)"}}
        }
    }
})

# Differential equations
def dx_dt(x, t):
    theta, omega = x
    dtheta_dt = omega
    domega_dt = -(b / (m * L)) * omega - (g / L) * math.sin(theta) + (F_d / (m * L)) * math.sin(omega_d * t)
    return [dtheta_dt, domega_dt]

# RK4 step
def rk4_step(x, t):
    k1 = dx_dt(x, t)
    k2 = dx_dt([x[0] + k1[0] * dt / 2, x[1] + k1[1] * dt / 2], t + dt / 2)
    k3 = dx_dt([x[0] + k2[0] * dt / 2, x[1] + k2[1] * dt / 2], t + dt / 2)
    k4 = dx_dt([x[0] + k3[0] * dt, x[1] + k3[1] * dt], t + dt)
    x_new = [x[0] + (dt / 6) * (k1[0] + 2*k2[0] + 2*k3[0] + k4[0]),
             x[1] + (dt / 6) * (k1[1] + 2*k2[1] + 2*k3[1] + k4[1])]
    return x_new

# Update parameters from sliders
def updateParams(ev=None):
    global b, F_d, omega_d
    b = float(document["damping"].value)
    F_d = float(document["drivingAmplitude"].value)
    omega_d = float(document["drivingFrequency"].value)
    document["dampingValue"].text = f"{b:.2f}"
    document["drivingAmplitudeValue"].text = f"{F_d:.1f}"
    document["drivingFrequencyValue"].text = f"{omega_d:.2f}"

# Animation function
def animate():
    global theta, omega, t, running
    if not running:
        return

    # Update position using RK4
    x = [theta, omega]
    x_new = rk4_step(x, t)
    theta, omega = x_new
    t += dt

    # Update canvas (draw pendulum)
    ctx.clearRect(0, 0, canvas.width, canvas.height)
    ctx.beginPath()
    pivot_x, pivot_y = canvas.width / 2, 50
    bob_x = pivot_x + 150 * math.sin(theta)  # Scaled length for visibility
    bob_y = pivot_y + 150 * math.cos(theta)
    ctx.moveTo(pivot_x, pivot_y)
    ctx.lineTo(bob_x, bob_y)
    ctx.strokeStyle = "black"
    ctx.lineWidth = 2
    ctx.stroke()
    ctx.beginPath()
    ctx.arc(bob_x, bob_y, 10, 0, 2 * math.pi)
    ctx.fillStyle = "red"
    ctx.fill()

    # Update chart
    time_data.append(t)
    theta_data.append(theta)
    if len(time_data) &gt; 200:  # Limit data points for performance
        time_data.pop(0)
        theta_data.pop(0)
    chart.data.labels = [f"{t:.1f}" for t in time_data]
    chart.data.datasets[0].data = theta_data
    chart.update()

    # Schedule next frame
    timer.set_timeout(animate, 10)

# Start and stop functions
def startSimulation(ev=None):
    global running, t, theta, omega, time_data, theta_data
    if not running:
        running = True
        t = 0.0
        theta = theta_0
        omega = omega_0
        time_data = []
        theta_data = []
        animate()

def stopSimulation(ev=None):
    global running
    running = False

# Bind functions to window for JavaScript calls
window.startSimulation = startSimulation
window.stopSimulation = stopSimulation
window.updateParams = updateParams

# Initial parameter update
updateParams()
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
"""

# Display the HTML in Jupyter
HTML(html_content)
</code></pre>
<hr/>
<h2 id="3-analysis-of-dynamics"><strong>3. Analysis of Dynamics</strong></h2>
<h3 id="31-influence-of-parameters"><strong>3.1 Influence of Parameters</strong></h3>
<ul>
<li><strong>Damping coefficient <span class="arithmatex">\((\gamma)\)</span></strong>:</li>
<li>High damping suppresses oscillations.</li>
<li>Low damping allows oscillations to persist longer.</li>
<li><strong>Driving force amplitude <span class="arithmatex">\(( A )\)</span></strong>:</li>
<li>Larger $ A $ can lead to chaotic motion.</li>
<li><strong>Driving frequency <span class="arithmatex">\(( \omega )\)</span></strong>:</li>
<li>At <span class="arithmatex">\(\omega \approx \omega_0\)</span>, resonance occurs.</li>
<li>For high <span class="arithmatex">\(\omega\)</span>, behavior becomes irregular.</li>
</ul>
<h3 id="32-transition-to-chaos"><strong>3.2 Transition to Chaos</strong></h3>
<p>As forcing increases, the system moves from periodic motion to quasiperiodic and eventually chaotic behavior. This is analyzed using:
- <strong>Phase portraits</strong> (visualizing velocity vs. displacement)
- <strong>Poincaré sections</strong> (snapshots at regular time intervals)
- <strong>Bifurcation diagrams</strong> (tracking equilibrium solutions as parameters vary)</p>
<hr/>
<h2 id="4-practical-applications"><strong>4. Practical Applications</strong></h2>
<ul>
<li><strong>Energy Harvesting</strong>: Piezoelectric pendulums convert oscillations into electrical energy.</li>
<li><strong>Suspension Bridges</strong>: Understanding resonance prevents structural failures.</li>
<li><strong>Electrical Circuits</strong>: Analogous to forced RLC circuits.</li>
<li><strong>Biomechanics</strong>: Gait patterns modeled using pendulum dynamics.</li>
</ul>
<hr/>
<h2 id="5-computational-implementation"><strong>5. Computational Implementation</strong></h2>
<h3 id="51-numerical-simulation"><strong>5.1 Numerical Simulation</strong></h3>
<p>The forced damped pendulum equation is solved using numerical integration (Runge-Kutta method). The code generates:
- <strong>Motion plots</strong> for varying parameters.
- <strong>Phase portraits</strong> to visualize periodic and chaotic behavior.
- <strong>Poincaré sections</strong> for transition analysis.
- <strong>Bifurcation diagrams</strong> to study nonlinear effects.</p>
<h3 id="52-model-limitations-extensions"><strong>5.2 Model Limitations &amp; Extensions</strong></h3>
<h4 id="limitations"><strong>Limitations</strong>:</h4>
<ul>
<li>Small-angle approximations break down at large amplitudes.</li>
<li>Linear damping does not always accurately model real-world resistance.</li>
<li>External forcing is not always purely periodic.</li>
</ul>
<h4 id="extensions"><strong>Extensions</strong>:</h4>
<ul>
<li>Nonlinear damping (e.g., quadratic drag) can be incorporated.</li>
<li>Stochastic forcing to simulate real-world perturbations.</li>
<li>Coupled oscillators for multi-degree-of-freedom systems.</li>
</ul>
<hr/>
</div>
</div><footer>
<div aria-label="Footer Navigation" class="rst-footer-buttons" role="navigation">
<a class="btn btn-neutral float-left" href="../Problem_1/" title="Problem 1"><span class="icon icon-circle-arrow-left"></span> Previous</a>
<a class="btn btn-neutral float-right" href="../../2%20Gravity/Problem_1/" title="Problem 1">Next <span class="icon icon-circle-arrow-right"></span></a>
</div>
<hr/>
<div role="contentinfo">
<!-- Copyright etc -->
</div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
</div>
</div>
</section>
</div>
<div aria-label="Versions" class="rst-versions" role="note">
<span class="rst-current-version" data-toggle="rst-current-version">
<span><a href="../Problem_1/" style="color: #fcfcfc">« Previous</a></span>
<span><a href="../../2%20Gravity/Problem_1/" style="color: #fcfcfc">Next »</a></span>
</span>
</div>
<script src="../../../js/jquery-3.6.0.min.js"></script>
<script>var base_url = "../../..";</script>
<script src="../../../js/theme_extra.js"></script>
<script src="../../../js/theme.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script src="../../../search/main.js"></script>
<script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>
</body>
</html>
